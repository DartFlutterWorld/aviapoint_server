# Пошаговая инструкция: Создание подписки на год в App Store Connect

## Шаг 1: Создание Subscription Group

1. Войдите в [App Store Connect](https://appstoreconnect.apple.com)
2. Выберите ваше приложение "РосАвиаТест - AviaPoint"
3. Перейдите: **App Store** → **Встроенные покупки** (In-App Purchases)
4. Нажмите **"+"** рядом с "Встроенные покупки"
5. Выберите **"Создать группу подписок"** (Create Subscription Group)
6. Название группы: **"РосАвиаТест Подписки"** или **"AviaPoint Subscriptions"**
7. Нажмите **"Создать"**

## Шаг 2: Создание продукта подписки на год

1. В созданной группе подписок нажмите **"+"** для добавления продукта
2. В модальном окне выберите:
   - **Тип:** ⚠️ **"Автоматически возобновляемая подписка"** (Auto-Renewable Subscription)
     - **НЕ выбирайте** "Расходуемая покупка" (Consumable) - это для одноразовых покупок
   
3. Заполните поля:
   - **Оригинальное название (Reference Name):**
     ```
     РосАвиаТест - Годовая подписка
     ```
     - Это внутреннее название, видно только вам
   
   - **ID продукта (Product ID):**
     ```
     com.aviapoint.subscription.rosaviatest.yearly
     ```
     - ⚠️ **Важно:** 
       - Должен быть уникальным
       - Нельзя изменить после создания
       - Формат: `com.ваш_bundle_id.подписка.период`
   
4. Нажмите **"Создать"**

## Шаг 3: Настройка подписки

После создания продукта откроется страница настройки:

### 3.1. Период подписки
- Выберите **"1 год"** (1 Year) или **"12 месяцев"** (12 Months)

### 3.2. Локализация (Localization)
Добавьте информацию на русском и английском:

**Русский язык:**
- **Название:** `РосАвиаТест - Годовая подписка`
- **Описание:** 
  ```
  Получите полный доступ к тестам РосАвиа на год. 
  Неограниченное количество попыток, все категории вопросов, 
  статистика и прогресс обучения.
  ```

**Английский язык:**
- **Название:** `RosAviaTest - Yearly Subscription`
- **Описание:**
  ```
  Get full access to RosAvia tests for a year.
  Unlimited attempts, all question categories,
  statistics and learning progress.
  ```

### 3.3. Ценообразование (Pricing)
- Выберите **"Match my price in other currencies"** для автоматической конвертации
- Или установите цены вручную для каждой страны
- **Рекомендуемая цена:** 2990₽ (или эквивалент в других валютах)

### 3.4. Период бесплатного пробного периода (Free Trial)
- Опционально: можно добавить бесплатный пробный период (например, 7 дней)
- Если не нужен - оставьте "Нет пробного периода"

### 3.5. Период промо-цены (Promotional Pricing)
- Опционально: можно настроить промо-цены для новых подписчиков

## Шаг 4: Сохранение и отправка на проверку

1. Проверьте все поля
2. Нажмите **"Сохранить"** (Save)
3. Подписка будет в статусе **"Готово к отправке"** (Ready to Submit)
4. После сохранения всех изменений приложения, подписка будет отправлена на проверку вместе с приложением

## Важные замечания

1. **Product ID должен совпадать с кодом:**
   - В сервере используется маппинг: если Product ID содержит "yearly" или "year", то используется тип подписки `yearly`
   - Убедитесь, что Product ID содержит слово "yearly" или "year"

2. **Для тестирования:**
   - Создайте Sandbox Test Account в App Store Connect
   - Используйте его для тестирования покупок
   - В коде установите `is_sandbox: true` при верификации

3. **После создания:**
   - Product ID будет использоваться в iOS приложении
   - Сервер будет автоматически определять тип подписки по Product ID
   - Подписка активируется автоматически после успешной верификации

## Примеры Product ID для других периодов

Если позже захотите добавить другие периоды:

- Месячная подписка: `com.aviapoint.subscription.rosaviatest.monthly`
- Квартальная подписка: `com.aviapoint.subscription.rosaviatest.quarterly`
- Годовая подписка: `com.aviapoint.subscription.rosaviatest.yearly` ✅ (этот создаем сейчас)

## Проверка настройки

После создания проверьте:
- ✅ Тип: Auto-Renewable Subscription
- ✅ Период: 1 год
- ✅ Product ID содержит "yearly" или "year"
- ✅ Локализация заполнена (минимум русский и английский)
- ✅ Цены установлены
