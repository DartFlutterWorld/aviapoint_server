# ğŸ›ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° AviaPoint Server

## ğŸ“ ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Internet / Clients                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTPS:443
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Nginx (Reverse Proxy)                           â”‚
â”‚  - SSL/TLS Termination                                      â”‚
â”‚  - Load Balancing                                           â”‚
â”‚  - Static Files (Caching)                                   â”‚
â”‚  - Rate Limiting                                            â”‚
â”‚  - GZIP Compression                                         â”‚
â”‚  - Security Headers                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP:8080
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Dart HTTP Server (Shelf Framework)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Middleware Stack:                                     â”‚  â”‚
â”‚  â”‚  1. Request Logging                                   â”‚  â”‚
â”‚  â”‚  2. CORS Headers                                      â”‚  â”‚
â”‚  â”‚  3. Error Handling                                    â”‚  â”‚
â”‚  â”‚  4. Database Request Logging                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Controllers/Routers:                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ ProfileController (/api/profiles/*)               â”‚ â”‚
â”‚  â”‚  â”œâ”€ AuthController (/auth/*)                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ NewsController (/api/news/*)                      â”‚ â”‚
â”‚  â”‚  â”œâ”€ StoriesController (/api/stories/*)                â”‚ â”‚
â”‚  â”‚  â”œâ”€ HandBookController (/learning/handbook/*)         â”‚ â”‚
â”‚  â”‚  â”œâ”€ VideoController (/learning/videos/*)              â”‚ â”‚
â”‚  â”‚  â”œâ”€ RosAviaTestController (/learning/tests/*)         â”‚ â”‚
â”‚  â”‚  â””â”€ SwaggerUI (/openapi/*)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Business Logic (Repositories):                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ ProfileRepository                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ AuthRepository                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ NewsRepository                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€ StoriesRepository                                  â”‚ â”‚
â”‚  â”‚  â””â”€ RosAviaTestRepository                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ PostgreSQL            â”‚ Static Files
                 â”‚ TCP:5432              â”‚ (public/)
                 â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  PostgreSQL 15  â”‚    â”‚  Assets & Images â”‚
        â”‚    Database     â”‚    â”‚   (public/)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
aviapoint_server/
â”œâ”€â”€ lib/                           # Dart Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
â”‚   â”œâ”€â”€ main.dart                  # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config/                # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”œâ”€â”€ setup_dependencies/    # DI Setup (GetIt)
â”‚   â”‚   â””â”€â”€ wrap_response.dart     # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”‚   â”œâ”€â”€ auth/                      # ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â””â”€â”€ token/
â”‚   â”œâ”€â”€ profiles/                  # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑĞ¼Ğ¸
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â””â”€â”€ data/
â”‚   â”œâ”€â”€ learning/                  # ĞĞ±ÑƒÑ‡Ğ°ÑÑ‰Ğ¸Ğµ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹
â”‚   â”‚   â”œâ”€â”€ hand_book/
â”‚   â”‚   â”œâ”€â”€ video_for_students/
â”‚   â”‚   â””â”€â”€ ros_avia_test/
â”‚   â”œâ”€â”€ news/                      # Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ĞµĞ¹
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â”œâ”€â”€ stories/                   # Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â””â”€â”€ logger/                    # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”œâ”€â”€ public/                        # Ğ¡Ñ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
â”‚   â”œâ”€â”€ open_api.yaml              # OpenAPI ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ normal/                    # ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
â”‚   â”œâ”€â”€ preflight/                 # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ°Ğ¼Ğ¾Ğ»ĞµÑ‚Ğ° (Ğ²Ğ¸Ğ´ĞµĞ¾/Ñ„Ğ¾Ñ‚Ğ¾)
â”‚   â”œâ”€â”€ stories/                   # Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
â”‚   â”œâ”€â”€ video_for_students/        # Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹
â”‚   â””â”€â”€ news/                      # ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
â”œâ”€â”€ pubspec.yaml                   # Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Dart
â”œâ”€â”€ docker-compose.yaml            # Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
â”œâ”€â”€ docker-compose.prod.yaml       # ĞŸÑ€Ğ¾Ğ´Ğ°ĞºÑˆĞµĞ½
â”œâ”€â”€ Dockerfile                     # Docker Ğ¾Ğ±Ñ€Ğ°Ğ·
â”œâ”€â”€ nginx.conf                     # Nginx ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³
â”œâ”€â”€ env.example                    # ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
â”œâ”€â”€ DEPLOYMENT.md                  # ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ñ‹Ğ¹ Ğ³Ğ°Ğ¹Ğ´ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ
â”œâ”€â”€ HOSTING_GUIDE.md               # Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ĞµĞ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒ
â””â”€â”€ start.sh                       # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°
```

## ğŸ”„ ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° (Request Flow)

```
1. CLIENT SENDS REQUEST
   â””â”€> https://example.com/api/profiles/123

2. NGINX (Reverse Proxy)
   â”œâ”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ SSL ÑĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚ âœ…
   â”œâ”€ ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚ rate limiting âœ…
   â”œâ”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ĞºÑÑˆ âœ…
   â”œâ”€ Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ âœ…
   â””â”€> ĞŸĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ½Ğ° 127.0.0.1:8080

3. DART SERVER
   â”œâ”€ logRequests() middleware
   â”œâ”€ corsHeaders() middleware
   â”œâ”€ handleErrors() middleware
   â”œâ”€ logDatabaseRequests() middleware
   â””â”€> ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ½Ğ° Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ controller

4. CONTROLLER (ProfileController)
   â”œâ”€ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
   â”œâ”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ (JWT token)
   â””â”€> Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ProfileRepository

5. REPOSITORY (ProfileRepository)
   â”œâ”€ Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
   â”œâ”€ Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ² PostgreSQL
   â”œâ”€ ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
   â””â”€> Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¾Ğ±ÑŠĞµĞºÑ‚ Profile

6. RESPONSE
   â”œâ”€ Ğ¡ĞµÑ€Ğ¸Ğ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ Ğ² JSON
   â”œâ”€ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
   â””â”€> https://example.com/api/profiles/123
       â”œâ”€ Content-Type: application/json
       â”œâ”€ Cache-Control: max-age=300
       â”œâ”€ X-Frame-Options: SAMEORIGIN
       â””â”€ Strict-Transport-Security: ...
```

## ğŸ” Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
- **JWT Ñ‚Ğ¾ĞºĞµĞ½Ñ‹** Ğ´Ğ»Ñ API
- **Bearer Ñ‚Ğ¾ĞºĞµĞ½Ñ‹** Ğ² Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ°Ñ…
- **Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ** Ğ¿ĞµÑ€ĞµĞ´ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ¼

```dart
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ñ‚Ğ¾ĞºĞµĞ½Ğ°
if (authHeader == null || !authHeader.startsWith('Bearer ')) {
  return Response.unauthorized('Unauthorized');
}
final token = authHeader.substring(7);
final isValid = getIt.get<TokenService>().validateToken(token);
```

### CORS (Cross-Origin Resource Sharing)
- ĞĞ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¾ Ğ² middleware
- Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ñ‹ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğµ origins
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ preflight Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹

### SSL/TLS
- HTTPS Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ĞµĞ½
- Auto-renewal Let's Encrypt ÑĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²
- HTTP Ñ€ĞµĞ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¸Ñ‚ÑÑ Ğ½Ğ° HTTPS

### Rate Limiting
- **General endpoints:** 10 req/sec
- **API endpoints:** 30 req/sec
- **Swagger UI:** 10 req/sec

### Security Headers
```
Strict-Transport-Security: max-age=31536000
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: no-referrer-when-downgrade
```

## ğŸ“Š ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ

### Current Bottlenecks:
1. **Database connections** - Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ connection pooling
2. **Static files** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ CDN (Cloudflare)
3. **Single instance** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ load balancer

### Future Improvements:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load Balancer (Nginx/HAProxy)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”œâ”€> App Instance 1 (8080)              â”‚
â”‚  â”œâ”€> App Instance 2 (8080)              â”‚
â”‚  â””â”€> App Instance 3 (8080)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PostgreSQL Master-Slave Replication     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Redis Cache Layer                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cloudflare CDN (Static Files)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—„ï¸ Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### PostgreSQL Schema

**ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ (Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ):**
- `users` - Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
- `auth_tokens` - JWT Ñ‚Ğ¾ĞºĞµĞ½Ñ‹
- `news` - Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸
- `stories` - Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸
- `questions` - Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
- `answers` - Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹ Ğ½Ğ° Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹

### Connection Config
```dart
class Config {
  static final String dbHost = Platform.environment['POSTGRESQL_HOST'] ?? 'localhost';
  static final String dbPassword = Platform.environment['POSTGRESQL_PASSWORD'] ?? 'password';
  static final int serverPort = 8080;
  static final String database = 'aviapoint';
  static final String username = 'postgres';
}
```

## ğŸ³ Docker Stack

### Development Environment
```yaml
db:        PostgreSQL (Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹)
app:       (Ğ½Ğµ Ğ½ÑƒĞ¶ĞµĞ½ - running Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾)
adminer:   Web UI Ğ´Ğ»Ñ Ğ‘Ğ” (Ğ¿Ğ¾Ñ€Ñ‚ 8082)
```

### Production Environment
```yaml
db:        PostgreSQL (Alpine, Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½)
app:       Compiled Dart app
nginx:     Reverse proxy + SSL
```

### Volumes
- `db_data:/var/lib/postgresql/data` - Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ‘Ğ”
- `./ssl:/etc/nginx/ssl` - SSL ÑĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ñ‹
- `./public:/app/public` - ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

## ğŸ“¡ API Endpoints

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹:
- `GET /openapi/` - Swagger UI
- `GET /public/open_api.yaml` - OpenAPI ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
- `POST /auth/login` - Ğ’Ñ…Ğ¾Ğ´
- `POST /auth/register` - Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
- `GET /api/profiles/:id` - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ
- `GET /api/news` - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ĞµĞ¹
- `GET /learning/handbook` - Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ¸Ğº
- `GET /learning/tests` - Ğ¢ĞµÑÑ‚Ñ‹
- `GET /learning/videos` - Ğ’Ğ¸Ğ´ĞµĞ¾

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Default |
|-----------|---------|---------|
| `POSTGRESQL_HOST` | Ğ¥Ğ¾ÑÑ‚ Ğ‘Ğ” | localhost |
| `POSTGRESQL_PASSWORD` | ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ‘Ğ” | password |
| `POSTGRESQL_DB` | Ğ˜Ğ¼Ñ Ğ‘Ğ” | aviapoint |
| `POSTGRESQL_USER` | ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ‘Ğ” | postgres |
| `SERVER_PORT` | ĞŸĞ¾Ñ€Ñ‚ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ | 8080 |
| `DART_ENV` | ĞĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ | development |

## ğŸ“ˆ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ¸:
- **talker** - Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ history tracking
- **logger** - Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- **shelf_cors_headers** - CORS headers

### Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ:
- Ğ’ÑĞµ HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
- ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ¸ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
- Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº Ğ‘Ğ”
- ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ»Ğ¾Ğ³Ğ¾Ğ²:
```
[INFO] Request started: GET /api/profiles
[INFO] Request completed: GET /api/profiles took 125ms
[ERROR] Error handling request: Connection refused
```

## ğŸš€ Deployment Pipeline

```
Developer
    â†“
git push origin main
    â†“
GitHub Actions
    â”œâ”€ Run tests (dart test)
    â”œâ”€ Analyze code (dart analyze)
    â”œâ”€ Build Docker image
    â””â”€ Push to registry
    â†“
Deploy (SSH)
    â”œâ”€ Git pull latest
    â”œâ”€ docker-compose pull
    â”œâ”€ docker-compose up -d
    â””â”€ Health checks
    â†“
Production
```

## ğŸ“ ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ

1. **Ğ§ÑƒĞ²ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ environment Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ
2. **ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ‘Ğ”** - Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ² `init-db.sql`
3. **Ğ¢ĞµÑÑ‚Ñ‹** - Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ñ‚ÑŒ
4. **Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ API** - Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¸Ğ· OpenAPI
5. **Backup** - Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ cron job Ğ´Ğ»Ñ ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ³Ğ¾ Ğ±ÑĞºĞ°Ğ¿Ğ°

